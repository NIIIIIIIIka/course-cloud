server:
  port: 8090 # Gateway 服务端口

spring:
  application:
    name: gateway-service # 服务名，注册到 Nacos
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 # Nacos 服务地址（默认）
        namespace: dev  # 修改为 dev 命名空间
        group: COURSEHUB_GROUP  # 如果需要，也统一分组
    gateway:
      discovery:
        locator:
          enabled: false
      # 路由规则配置：转发请求到各微服务
      routes:
        # User Service路由
        - id: user-service
          uri: lb://user-service?group=COURSEHUB_GROUP&namespace=dev # 负载均衡方式访问 Nacos 中的 user-service
          predicates:
            - Path=/api/users/**, /api/auth/**,/api/api/users/**,/api/api/auth/** # 匹配路径（包含登录接口）
          filters:
            - StripPrefix=0 # 去掉路径前缀 /api，转发到 user-service 的 /users/** 或 /auth/**
        # Catalog Service 路由
        - id: catalog-service
          uri: lb://catalog-service?group=COURSEHUB_GROUP&namespace=dev
          predicates:
            - Path=/api/catalogs/** , /api/catalog/** , /api/courses/**,/api/api/courses/**
          filters:
            - StripPrefix=0
        # Enrollment Service 路由
        - id: enrollment-service
          uri: lb://enrollment-service?group=COURSEHUB_GROUP&namespace=dev
          predicates:
            - Path=/api/enrollments/**,/api/api/enrollments/**
          filters:
            - StripPrefix=0
      # CORS 跨域配置：允许前端跨域访问
      globalcors:
        cors-configurations:
          '[/**]':
            allowed-origin-patterns: "*"
            allowed-methods: "*" # 允许所有 HTTP 方法
            allowed-headers: "*" # 允许所有请求头
            allow-credentials: true # 允许携带 Cookie

# JWT 配置
jwt:
  secret: your-256bit-secret-key-here-1234567890abcdefghijklmnopqrstuvwxyz # 至少 256 位密钥
  expiration: 86400000 # Token 有效期：24 小时（单位：毫秒）
logging:
  level:
    org.springframework.cloud.gateway: DEBUG  # 网关核心日志
    org.springframework.cloud.loadbalancer: DEBUG  # 负载均衡日志
    org.springframework.boot.context.config: TRACE
    org.springframework.cloud.bootstrap: DEBUG